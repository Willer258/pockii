# Epic 1 Retrospective - Foundation & First Budget View

**Date:** 2026-01-10
**Epic:** 1 - Foundation & First Budget View
**Status:** Complete (6/6 stories)

## Epic Summary

### Delivery Metrics
- **Stories Completed:** 6/6 (100%)
- **Total Tests:** 341+
- **Code Reviews:** 6 (all with corrections applied)
- **Issues Found/Fixed:** ~25 issues across all stories

### Stories Delivered
| Story | Title | Status |
|-------|-------|--------|
| 1-1 | Project Bootstrap & Encrypted Database | Done |
| 1-2 | Theme & Design System Foundation | Done |
| 1-3 | Home Screen & BudgetHeroCard | Done |
| 1-4 | Onboarding Flow & Budget Setup | Done |
| 1-5 | Budget Period Calculation Logic | Done |
| 1-6 | Empty States & First Launch Guidance | Done |

## What Went Well

1. **Systematic Code Reviews**
   - Every story was reviewed before completion
   - Issues were identified and fixed promptly
   - Code quality improved iteratively

2. **Reusable Patterns Established**
   - `FcfaFormatter` - centralized FCFA formatting
   - `clockProvider` - injectable time for testability
   - `BudgetColors` - consistent budget status colors
   - Feature-based architecture with clean separation

3. **High Test Coverage**
   - 341+ tests across unit and widget tests
   - ~57 tests per story average
   - Strong foundation for future development

4. **Architecture Compliance**
   - FCFA as int only - zero violations
   - Riverpod 2.x StateNotifierProvider pattern followed
   - Feature-based folder structure maintained

## Challenges & Recurring Issues

### High Frequency Issues (3+ occurrences)

1. **DateTime.now() Violations**
   - Appeared in: Stories 1-1, 1-4, 1-5
   - Issue: Direct DateTime.now() usage instead of clockProvider
   - Impact: Testability compromised
   - Root Cause: Natural coding habit, easy to forget
   - **Action:** Consider custom lint rule

2. **DRY Violations - Duplicated Formatting**
   - Appeared in: Stories 1-3, 1-4
   - Issue: `_formatWithSpaces()` copied instead of using FcfaFormatter
   - Impact: Increased maintenance burden
   - **Action:** Document FcfaFormatter in project-context.md

3. **Missing Widget Tests**
   - Appeared in: Stories 1-1, 1-3, 1-6
   - Issue: Unit tests present but widget tests missing
   - Impact: Incomplete UI coverage
   - **Action:** Add widget test checklist to story template

### Occasional Issues

4. **Dead Code** (Story 1-4)
   - Unused providers left in codebase

5. **Documentation Inconsistencies** (Story 1-4)
   - Files listed in story that don't exist

6. **French Grammar** (Story 1-6)
   - Singular/plural handling ("1 jours" vs "1 jour")

## Action Items

| # | Action | Owner | Priority | Deadline |
|---|--------|-------|----------|----------|
| 1 | Create custom lint rule for DateTime.now() detection | Dev | HIGH | Before Epic 2 Story 3 |
| 2 | Add widget test checklist to story template | SM | MEDIUM | Before Epic 2 |
| 3 | Document FcfaFormatter in project-context.md | Dev | LOW | Before Epic 2 |

## Team Agreements

1. **Always use clockProvider** - Never DateTime.now() directly
2. **Check for FcfaFormatter** - Use existing utility, don't duplicate
3. **Widget tests required** - Every UI component needs widget tests
4. **Code review before done** - No story marked done without review

## Next Epic Preview

### Epic 2: Transaction Tracking

**Objective:** User can add, edit, and delete transactions in <10 seconds with instant budget update.

**Stories Planned (8):**
1. 2-1: Transactions Database Table & Repository
2. 2-2: Add Expense Bottom Sheet
3. 2-3: Add Income Flow
4. 2-4: Category Selection Component
5. 2-5: Transaction History Screen
6. 2-6: Edit Existing Transaction
7. 2-7: Delete Transaction (Swipe)
8. 2-8: Transaction Amount Validation

**Dependencies on Epic 1:**
- BudgetCalculationService ready with transaction stubs
- FcfaFormatter available for amount display
- BudgetHeroCard ready to show updated totals
- Theme system ready for UI components

**Preparation Required:**
1. Verify `transactions` table schema defined
2. Create widget test template for bottom sheets
3. Document FcfaFormatter in project-context.md

**Significant Changes:** None detected - Epic 2 plan remains valid.

## Key Lessons Learned

1. **Testability requires discipline** - clockProvider pattern is critical but easy to forget
2. **DRY applies to utilities** - Check shared/utils before creating local helpers
3. **Code reviews catch patterns** - Systematic reviews found recurring issues
4. **Foundation quality matters** - Strong Epic 1 enables smooth Epic 2

## Retrospective Participants

- Bob (Scrum Master) - Facilitator
- Alice (Product Owner)
- Charlie (Senior Dev)
- Dana (QA Engineer)
- Elena (Junior Dev)
- Wilfriedhouinlindjonon (Project Lead)

---

**Next Steps:**
1. Execute preparation tasks before Epic 2
2. Start Epic 2 with `create-story 2-1`
3. Review action items in next standup

**Retrospective Status:** Complete
